<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CanterPro</title>

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f4f6f8;
}

header {
  background: #1976d2;
  color: #fff;
  padding: 14px;
  text-align: center;
  font-size: 20px;
  font-weight: 600;
}

.container {
  padding: 16px;
}

.hidden {
  display: none;
}

.center {
  text-align: center;
  margin-top: 80px;
}

.card {
  background: #fff;
  border-radius: 18px;
  padding: 16px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.06);
}

.shift-item {
  padding: 12px 0;
  border-bottom: 1px solid #eee;
}

.shift-item:last-child {
  border-bottom: none;
}

button {
  width: 100%;
  padding: 16px;
  border: none;
  border-radius: 30px;
  font-size: 18px;
  font-weight: 600;
}

.primary {
  background: #1976d2;
  color: #fff;
}

.secondary {
  background: #e0e0e0;
  color: #333;
}

.danger {
  background: #d32f2f;
  color: #fff;
}
</style>
</head>

<body>

<header>CanterPro</header>

<div class="container">

<!-- ================== START SCREEN ================== -->
<div id="startScreen" class="center">
  <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h2>
  <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ</p>
  <br>

  <button class="primary" onclick="startShift()">
    –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—á—É—é —Å–º–µ–Ω—É
  </button>

  <br><br>

  <button class="secondary" onclick="openReports()">
    –û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
  </button>
</div>

<!-- ================== SHIFT SCREEN ================== -->
<div id="shiftScreen" class="hidden">
  <div class="card">
    <h3>üïò –†–∞–±–æ—á–∞—è —Å–º–µ–Ω–∞</h3>

    <div id="shiftInfo"></div>

    <br>

    <button class="danger" onclick="endShift()">
      –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—á—É—é —Å–º–µ–Ω—É
    </button>
  </div>
</div>

<!-- ================== REPORTS SCREEN ================== -->
<div id="reportsScreen" class="hidden">
  <div class="card">
    <h3>üìä –û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>

    <div id="reportsContent"></div>

    <br>

    <button class="secondary" onclick="goToStart()">
      –ù–∞ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
    </button>
  </div>
</div>

</div>

<script>
/* ================== STATE ================== */

let activeShift = JSON.parse(localStorage.getItem("activeShift"));
let archiveShifts = JSON.parse(localStorage.getItem("archiveShifts")) || [];
let appMode = localStorage.getItem("appMode"); // null | reports

/* ================== ACTIONS ================== */

function startShift() {
  if (activeShift) {
    alert(
      "–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ä–∞–±–æ—á–∞—è —Å–º–µ–Ω–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.\n" +
      "–ó–∞–≤–µ—Ä—à–∏—Ç–µ –µ—ë –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–π."
    );
    return;
  }

  const now = new Date();

  activeShift = {
    id: Date.now(),
    startDate: now.toLocaleDateString(),
    startTime: now.toLocaleTimeString(),
    endTime: null,
    status: "active"
  };

  localStorage.setItem("activeShift", JSON.stringify(activeShift));
  render();
}

function endShift() {
  if (!activeShift) return;

  activeShift.endTime = new Date().toLocaleTimeString();
  activeShift.status = "finished";

  archiveShifts.push(activeShift);
  localStorage.setItem("archiveShifts", JSON.stringify(archiveShifts));

  localStorage.removeItem("activeShift");
  activeShift = null;

  render();
}

function openReports() {
  if (activeShift) return; // –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–∞–±–æ—á–µ–π —Å–º–µ–Ω—ã
  appMode = "reports";
  localStorage.setItem("appMode", "reports");
  render();
}

function goToStart() {
  appMode = null;
  localStorage.removeItem("appMode");
  render();
}

/* ================== RENDER ================== */

function render() {
  startScreen.classList.add("hidden");
  shiftScreen.classList.add("hidden");
  reportsScreen.classList.add("hidden");

  if (activeShift) {
    shiftScreen.classList.remove("hidden");
    shiftInfo.innerHTML = `
      <p>üìÖ <b>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:</b> ${activeShift.startDate}</p>
      <p>‚è± <b>–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞:</b> ${activeShift.startTime}</p>
    `;
    return;
  }

  if (appMode === "reports") {
    reportsScreen.classList.remove("hidden");

    if (archiveShifts.length === 0) {
      reportsContent.innerHTML = `
        <p>–ê—Ä—Ö–∏–≤ —Ä–∞–±–æ—á–∏—Ö —Å–º–µ–Ω –ø—É—Å—Ç.</p>
      `;
    } else {
      reportsContent.innerHTML = archiveShifts
        .map(shift => `
          <div class="shift-item">
            <p><b>${shift.startDate}</b></p>
            <p>${shift.startTime} ‚Äî ${shift.endTime}</p>
          </div>
        `)
        .join("");
    }
    return;
  }

  startScreen.classList.remove("hidden");
}

/* ================== INIT ================== */

render();
</script>

</body>
</html>
