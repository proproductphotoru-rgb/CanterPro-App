<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Driver App</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f172a;color:#fff}
header{background:#020617;padding:12px;display:flex;justify-content:space-between;align-items:center}
button{padding:10px;border:none;border-radius:8px;font-size:15px}
.primary{background:#2563eb;color:#fff}
.secondary{background:#334155;color:#fff}
.danger{background:#7f1d1d;color:#fff}
.screen{padding:14px}
.card{background:#020617;border-radius:10px;padding:12px;margin-top:10px;white-space:pre-line}
input,select{width:100%;padding:10px;margin-top:6px;border-radius:6px;border:none}
label{font-size:14px;margin-top:6px;display:block}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center}
.modal-content{background:#020617;padding:16px;width:95%;max-width:480px;border-radius:12px}
.hidden{display:none}
.small{font-size:13px;color:#94a3b8}
.red{color:#f87171;font-weight:bold}
</style>
</head>
<body>

<header>
  <div>üöö Driver App</div>
  <div>
    <button class="secondary" onclick="openCalc()">üßÆ</button>
    <button class="primary" onclick="openOrders()">üì¶</button>
  </div>
</header>

<div class="screen" id="mainScreen">
  <h3>–†–∞–±–æ—á–∞—è —Å–º–µ–Ω–∞</h3>
  <div id="shiftStatus" class="card">–°–º–µ–Ω–∞ –Ω–µ –Ω–∞—á–∞—Ç–∞</div>
  <button class="primary" onclick="startShift()">‚ñ∂ –ù–∞—á–∞—Ç—å —Å–º–µ–Ω—É</button>
  <button class="danger" onclick="endShift()">‚èπ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–º–µ–Ω—É</button>
</div>

<!-- –ó–ê–ö–ê–ó–´ -->
<div class="modal hidden" id="ordersModal">
<div class="modal-content">
<h3>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</h3>

<label>–¢–∏–ø —Ç–∞—Ä–∏—Ñ–∞</label>
<select id="orderType">
<option value="km">–ó–∞ –∫–∏–ª–æ–º–µ—Ç—Ä–∞–∂</option>
<option value="fix">–§–∏–∫—Å</option>
<option value="fix_km">–§–∏–∫—Å + –∫–º</option>
<option value="fix_fix">–§–∏–∫—Å + —Ñ–∏–∫—Å (–õ–û)</option>
<option value="5plus1">5 + 1</option>
</select>

<label>–ö–∏–ª–æ–º–µ—Ç—Ä–∞–∂</label>
<input id="orderKm" type="number">

<label>–°—Ç–∞–≤–∫–∞ ‚ÇΩ/–∫–º</label>
<input id="orderRate" type="number" value="70">

<label>–§–∏–∫—Å ‚ÇΩ</label>
<input id="orderFix" type="number">

<label>–ß–∞—Å–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (–¥–ª—è 5+1)</label>
<input id="orderHour" type="number" value="1000">

<label><input type="checkbox" id="orderWebasto"> üî• –í–µ–±–∞—Å—Ç–æ</label>
<label><input type="checkbox" id="orderFridge"> ‚ùÑÔ∏è –†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä</label>

<div class="red">‚ùó –ü–†–† –≤–æ–¥–∏—Ç–µ–ª—å –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç</div>

<button class="primary" onclick="finishOrder()">‚úî –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑</button>
<button class="secondary" onclick="closeOrders()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>
</div>

<!-- –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† -->
<div class="modal hidden" id="calcModal">
<div class="modal-content">
<h3>üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h3>

<label>–ö–º</label>
<input id="calcKm" type="number">

<label>–°—Ç–∞–≤–∫–∞ ‚ÇΩ/–∫–º</label>
<input id="calcRate" type="number" value="70">

<label><input type="checkbox" id="calcWebasto"> üî• –í–µ–±–∞—Å—Ç–æ (+15%)</label>
<label><input type="checkbox" id="calcFridge"> ‚ùÑÔ∏è –†–µ—Ñ (+20%)</label>

<div id="calcResult" class="card">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</div>

<button class="primary" onclick="calc()">–ü–æ—Å—á–∏—Ç–∞—Ç—å</button>
<button class="secondary" onclick="copyCalc()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="secondary" onclick="sendTG()">üì≤ Telegram</button>
<button class="secondary" onclick="closeCalc()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>
</div>

<script>
let shiftActive=false
let shiftStart=null
let totalIncome=0
let totalKm=0

function startShift(){
 if(shiftActive) return
 shiftActive=true
 shiftStart=new Date()
 shiftStatus.textContent=`–°–º–µ–Ω–∞ –Ω–∞—á–∞—Ç–∞: ${shiftStart.toLocaleString()}`
}

function endShift(){
 if(!shiftActive) return
 const end=new Date()
 const hours=((end-shiftStart)/3600000).toFixed(2)
 const fuel=(totalKm*12/100*76.04).toFixed(0)
 const amort=(totalIncome*0.2).toFixed(0)
 const tax=(totalIncome*0.06).toFixed(0)
 const clean=(totalIncome-fuel-amort-tax).toFixed(0)

 shiftStatus.textContent=
`–°–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
–í—Ä–µ–º—è: ${hours} —á
–ö–º: ${totalKm}
–î–æ—Ö–æ–¥ –≤–∞–ª–æ–≤—ã–π: ${totalIncome} ‚ÇΩ
–¢–æ–ø–ª–∏–≤–æ: ${fuel} ‚ÇΩ
–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è: ${amort} ‚ÇΩ
–ù–∞–ª–æ–≥: ${tax} ‚ÇΩ
–ß–ò–°–¢–´–ô –î–û–•–û–î: ${clean} ‚ÇΩ`

 shiftActive=false
 totalIncome=0
 totalKm=0
}

function openOrders(){ ordersModal.classList.remove("hidden") }
function closeOrders(){ ordersModal.classList.add("hidden") }

function finishOrder(){
 let sum=0
 const km=+orderKm.value||0
 const rate=+orderRate.value||0
 const fix=+orderFix.value||0
 const hour=+orderHour.value||0

 if(orderType.value==="km") sum=km*rate
 if(orderType.value==="fix") sum=fix
 if(orderType.value==="fix_km") sum=fix+km*rate
 if(orderType.value==="fix_fix") sum=fix
 if(orderType.value==="5plus1") sum=hour*6

 let coef=1
 if(orderWebasto.checked) coef+=0.15
 if(orderFridge.checked) coef+=0.20

 sum=Math.round(sum*coef)

 totalIncome+=sum
 totalKm+=km

 alert("–ó–∞–∫–∞–∑ –∑–∞–≤–µ—Ä—à—ë–Ω: "+sum+" ‚ÇΩ")
 closeOrders()
}

function openCalc(){ calcModal.classList.remove("hidden") }
function closeCalc(){ calcModal.classList.add("hidden") }

let calcText=""
function calc(){
 const km=+calcKm.value||0
 const rate=+calcRate.value||0
 let sum=km*rate
 let coef=1
 if(calcWebasto.checked) coef+=0.15
 if(calcFridge.checked) coef+=0.20
 sum=Math.round(sum*coef)

 calcText=
`üöö –ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

–ö–º: ${km}
–°—Ç–∞–≤–∫–∞: ${rate} ‚ÇΩ/–∫–º
${calcWebasto.checked?"üî• –í–µ–±–∞—Å—Ç–æ":""}
${calcFridge.checked?"‚ùÑÔ∏è –†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä":""}

–ò–¢–û–ì–û: ${sum} ‚ÇΩ

‚ùó –ü–†–† –≤–æ–¥–∏—Ç–µ–ª—å –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç`

 calcResult.textContent=calcText
}

function copyCalc(){
 navigator.clipboard.writeText(calcText)
 alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ")
}

function sendTG(){
 window.open("https://t.me/share/url?text="+encodeURIComponent(calcText))
}
</script>
</body>
</html>
